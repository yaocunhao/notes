- docker 拉一个全新的centos 环境，安装所有的东西就可以编译环境了

- 如果进行了多次拉取需要注意环境之中库的冲突

- [使用](https://blog.csdn.net/kenjianqi1647/article/details/106534972?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522170979309116800213050228%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=170979309116800213050228&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-106534972-null-null.142^v99^pc_search_result_base5&utm_term=thrift%20c%2B%2B%20%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B&spm=1018.2226.3001.4187)

- Thrift
  - 编译 
  - demo 使用方式
  - 移植

    ```shell
    #  1.编译命令 
    # -fPIE 与位置无关的库
    # --pre make install 会将静态库安装的位置
    ./configure --pre=/usr/local/ --with-ruby=no --with-python=no --with-java=no --with-go=no --with-perl=no --with-php=no --with-csharp=no --with-erlang=no --with-lua=no --with-nodejs=no --with-rs=no --with-py3=no CXXFLAGS='-Wno-error' CXXFLAGS=-fPIE
    
    # 2.使用
    # 有可能发生找不到声明，编译加上-std=c++11
    g++ hello_constants.cpp HelloService.cpp hello_types.cpp server.cpp  -I/usr/local/include /usr/local/lib/libthrift.a -lpthread
    
    
    ```

- 在brpc 
  - 编译（开启thrift支持）

    - 相关依赖项需要编译需要加-fPICE, 比如变异gflags`(cmake .. -DBUILD_SHARED_LIBS=ON -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX=./install -DCMAKE_CXX_FLAGS=-fPIC)`
    
    - 还可以`export CXXFLAGS=-fPIC`
    
    
    ```shell
    # 编译-1
    $ sh config_brpc.sh --headers="/usr/include /usr/local/include" --libs="/usr/lib64 /usr/bin /usr/local/lib/" --with-thrift
    sh config_brpc.sh --headers=/usr/include --libs=/usr/lib64 --with-thrift
    
    # 编译-2， 和上面是一样的记录使用而已
    sh config_brpc.sh --headers="/root/brpc2/brpc/thirdparty/gflags/include /root/brpc2/brpc/thirdparty/leveldb/include /usr/include /usr/local/include" --libs="/root/brpc2/brpc/thirdparty/gflags/lib  /root/brpc2/brpc/thirdparty/gflags  /root/brpc2/brpc/thirdparty/leveldb/lib /usr/lib64 /usr/bin /usr/local/lib/"
    
     sh config_brpc.sh --headers="/root/brpc2/thirdparty/gflags/include/ /root/brpc2/thirdparty/leveldb/include /root/brpc2/thirdparty/protobuf/include /usr/include" --libs="/root/brpc2/thirdparty/protobuf/lib  /root/brpc2/thirdparty/gflags/lib /root/brpc2/thirdparty/leveldb/lib64 /usr/lib64"
    
    make 
    # 会在build output 目录下输出静态库
    
    # notes: 自己构建依赖项时，需要在相关依赖项最后加上fPIE. 
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -fPIC")
    
    add_definitions(-D_GLIBCXX_USE_CXX11_ABI=0) # 这个在flags 后面加
    ```
    
  - Brpc 构建，会找不到库，因此需要修改CMakelsit

    ```shell
    # 1、编译方式
    
    
    # 1、gflags 通过source xxx 进行加入
    # 2、leveldb 通过指定头文件位置
     cmake -DLEVELDB_INCLUDE_PATH=/home/xiaoju/leveldb/build/install/include -DLEVELDB_LIB=/home/xiaoju/leveldb/build/install/lib/libleveldb.a -DCMAKE_INCLUDE_PATH="/user/include /user/local /opt/voy-sdk/include /home/xiaoju/leveldb/build/install/include/" -DCMAKE_LIBRARY_PATH="/usr/lib/x86_64-linux-gnu /opt/voy-sdk/lib/ /user/local/ /usr/lib /usr/lib32 /home/xiaoju/leveldb/build/install/lib " -DCMAKE_INSTALL_PREFIX=./install -DCMAKE_CXX_FLAGS=-fPIC -DWITH_SNAPPY=ON ..
    ```

    

  - demo 使用方式
  
    ```shell
    cd example/thrift_extension_c++
    make # 会有问题，需要找修改Makefile，增加头文件和库文件的搜索位置
    # 代码中google需要修改成gflags
    
    ```
  
  - 移植
  
    - 直接一直会缺少静态库，因此需要将静态库整理好
  
- grpc 的使用

  - [grpc 支持httpc访问](https://segmentfault.com/a/1190000008106582?utm_source=tuicool&utm_medium=referral)

  

  

- protobuf 使用

  - 

  - ```
    ./configure --prefix=/usr/local/protobuf 
    ```

  