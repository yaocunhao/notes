# 一、资料收集

- [link](https://juejin.cn/post/7132443310722908174)

  - 只能做到最终一致性。CAP理论。
- [Cap理论](https://juejin.cn/post/6844903833953370119)

  - 虽然CAP理论定义是三个要素中只能取两个，但放到分布式环境下来思考，我们会发现必须选择P（分区容错）要素，因为网络本身无法做到100%可靠，有可能出故障，所以分区是一个必然的现象。如果我们选了CA而放弃P，那么当发生分区现象时，为了保证C，系统需要禁止写入，当有写入请求时，系统返回error（例如，当前系统不允许写入），这又和A冲突了，因为A要求返回no error和 no timeout。因此，分布式系统理论上不可能选择CA架构，只能选择CP或者AP架构
- [缓存一致性最佳实践](https://juejin.cn/post/7051772135584301092)

  - **分布式场景下无法做到强一致**

    - 不同于 CPU 硬件缓存体系采用的 MESI 协议（[参考资料](https://link.juejin.cn?target=https%3A%2F%2Fwww.jianshu.com%2Fp%2F0e036fa7af2a)）以及硬件的强时钟控制，分布式场景下我们无法做到缓存与底层数据库的强一致，即把缓存和数据库的数据变更做成一个原子操作。硬件工程师设计了内存屏障（Memory Barrier）的概念，提供给软件开发者不同的一致性选项在性能与一致性上进行权衡。

  - **就算是达到最终一致性也很难**

    - 分布式场景下，要做到最终一致性，就要求缓存中存储的是最新版本的数据（或者缓存为空），而且是在数据库更新后很迅速的就要达到这个一致性的状态，要做到是极其困难的。我们会面临硬件、软件、通信等等组件非常多的异常情况
- [如何选择合适的缓存场景(方案选型)](https://juejin.cn/post/7054850937919111175)

  - 确认产品上对延迟性的要求，如果要求极高，且数据有可能变化，别用缓存
  - 能用缓存方案，通常是读多写少场景，同时业务上对延迟具有一定的包容性

- [使用缓存设置分布式锁文章](https://blog.csdn.net/weixin_38405253/article/details/115222355?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522168708233616800186598648%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=168708233616800186598648&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-2-115222355-null-null.142^v88^control_2,239^v2^insert_chatgpt&utm_term=mget%20%E6%98%AF%E5%8A%A0%E9%94%81%E7%9A%84%E4%B9%88&spm=1018.2226.3001.4187)

# 二、小结

- 缓存只能保证最终一致性，且同样存在隐患问题，因此缓存通常用于读多写少的情况，并且需要根据业务场景选择合适的缓存。 如果对数据要求比较高，那么就不要使用缓存