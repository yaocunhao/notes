- [参考链接](https://blog.csdn.net/lewif/article/details/78575840?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167619719416800188584937%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=167619719416800188584937&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-78575840-null-null.142^v73^insert_down3,201^v4^add_ask,239^v1^insert_chatgpt&utm_term=OpenDriver%20%E4%B9%8B%E4%B8%AD%E7%9A%84roadMark&spm=1018.2226.3001.4187)：总之，对于一个road来说，先确定reference line，有了reference line的几何形状和位置，然后再确定reference line左右的车道lane,车道lane又有实线和虚线等属性；road 和road之间通过普通连接和Junction进行连接，同时还要将road中的相关车道进行连接

- [Junction参考链接](https://blog.csdn.net/qq_39767850/article/details/122809208?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167626800316782425189836%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=167626800316782425189836&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-122809208-null-null.142^v73^insert_down3,201^v4^add_ask,239^v1^insert_chatgpt&utm_term=OpenDriver%20contactPoint&spm=1018.2226.3001.4187)

# 参数多项式(暂时了解)

- [参考链接](https://blog.csdn.net/YP233/article/details/115243737?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167620474116800225570133%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=167620474116800225570133&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-2-115243737-null-null.142^v73^insert_down3,201^v4^add_ask,239^v1^insert_chatgpt&utm_term=Parametric%20cubic%20curve%20%E5%8F%82%E6%95%B0%E4%B8%89%E6%AC%A1%E6%9B%B2%E7%BA%BF&spm=1018.2226.3001.4187)

- 参数三次曲线用于**描述根据测量数据生成的复杂曲线**

- 三次多项式我们会用到一个前文提到的很少用到的坐标系，那就是uv坐标系，前面说过，uv坐标系是根据st坐标系给出偏移生成的一个坐标系，那么是如何给定参数确定的这种偏移呢，答案是通过上面给出的a、b参数，参数b负责给出相对于st坐标系的航向角/偏向角，角度为arctan(b)，参数a负责给出当u = 0时，沿v坐标轴的偏移量。<font color=yellow>当uv坐标系与st坐标系重合时，a = b =c= 0</font>
  

#  一、参考线必要元素

- 参考线表示的是road的走向
- s=s_pre+length
- hdg：当前点位的航向角

```xml
<?xml version="1.0" standalone="yes"?>
<OpenDRIVE>
  <header revMajor="1" revMinor="6" name="" version="1.00" date="Mon Aug 10 15:45:34 2020"
    north="0.0000000000000000e+00" south="0.0000000000000000e+00" east="0.0000000000000000e+00"
    west="0.0000000000000000e+00">
  </header>
  <road name="" length="4039.2668785478495" id="23" junction="-1">
    <planView>
      <geometry s="0" x="287545.37816762" y="3464322.24947832" hdg="0.3612037554940928" length="1192.1498191899966"> <line/> </geometry>
      <geometry s="1192.1498191899966" x="288660.601054942" y="3464743.55590242" hdg="-0.6238234521782284" length="671.7420539566141"> <line/> </geometry>
      <geometry s="1863.8918731466106" x="289205.821133189" y="3464351.16266429" hdg="-1.9974238199189542" length="499.08479327544677"> <line/> </geometry>
      <geometry s="2362.9766664220574" x="288999.298376277" y="3463896.81259908" hdg="-3.0636973250776345" length="1061.58744663421"> <line/> </geometry>
      <geometry s="3424.564113056267" x="287940.929989092" y="3463814.20349632" hdg="2.2896263264193" length="614.7027654915825"> <line/> </geometry>
    </planView>
  </road>
</OpenDRIVE>
```

# 二、laneSection

- 一个road之中可以可以有多个lane，多个lane都包含在lanes标签之中，一个lans标签之中可以包含多个laneSection标签。一个laneSection之中lane的数量是恒定的，如果发生了变化就需要增加一个laneSection标签

  ```xml
  <laneSection s="110.0000000000000000e+00">
  ```

  

# 三、、lane

- lane的构成为在中心车道的基础上填充width字段，从而组成road，其中当中心线的偏移为0的时候<font color=yellow> 中心车道等同于参考线</font>

- **车道偏移**用<lanes>元素内的<laneOffset>元素来表示。理论上一个lane的宽度是恒定的，所以有了偏移的概念(了解阶段)

  ```xml
  <lanes>
  <laneOffset s="2.5000000000000000e+01" a="0.0000000000000000e+00" b="0.0000000000000000e+00" c="3.8999999999999998e-03" d="-5.1999999999999997e-05"/>
  <laneSection s="0.0000000000000000e+00">
    
  s： 起始位置
  a=b=c=0 表示st坐标不发生偏移
  d： 偏移的距离，如果不填写，则表示全段
    
  # 当前填充规则，只填充a即可，表示沿t方向偏移的距离，如下图所示
  ```

  ![image-20230212193631770](https://yrecord.oss-cn-hangzhou.aliyuncs.com/picture/202302121936876.png)

  - 如下代码所示，中心道路分别在2.5m和7.5处m进行偏移

    ```xml
    <lanes>
    <laneOffset s="2.5000000000000000e+01" a="0.0000000000000000e+00" b="0.0000000000000000e+00" c="3.8999999999999998e-03" d="-5.1999999999999997e-05"/>
    <laneOffset s="7.5000000000000000e+01" a="3.2500000000000000e+00" b="0.0000000000000000e+00" c="0.0000000000000000e+00" d="0.0000000000000000e+00"/><laneSection s="0.0000000000000000e+00">
    ```

    

- 车道宽度

  ```xml
  <lane id="1" type="none" level="false">
  
  <width sOffset="0" a="7.5" # 表示起始位置，宽度为7.5
     b="0.0000000000000000e+00" c="0.0000000000000000e+00" d="0.0000000000000000e+00" />
    
  <width sOffset="20" a="1.5" # 表示距离起始位置20m处，宽度为1.5，一直到最后
    b="0.0000000000000000e+00" c="0.0000000000000000e+00" d="0.0000000000000000e+00" />  
  ```

  

- 文件参考

  ```xml
  <?xml version="1.0" standalone="yes"?>
  <OpenDRIVE>
    <header revMajor="1" revMinor="4" name="" version="1.00" date="Mon Aug 10 15:45:34 2020"
      north="0.0000000000000000e+00" south="0.0000000000000000e+00" east="0.0000000000000000e+00"
      west="0.0000000000000000e+00">
    </header>
    <road name="" length="1.8283185307174625e+02" id="2" junction="-1">
      <link>
      </link>
      <type s="0.0000000000000000e+00" type="unknown" />
      <planView>
        <geometry s="0.0000000000000000e+00" x="1.7763568394002505e-15" y="4.0000000000000007e+01"
          hdg="2.3684757858670006e-16" length="3.0000000000000000e+01">
          <line />
        </geometry>
        <geometry s="3.0000000000000000e+01" x="3.0000000000000000e+01" y="4.0000000000000014e+01"
          hdg="0.0000000000000000e+00" length="1.5707963267948966e+01">
          <arc curvature="-1.0000000000000001e-01" />
        </geometry>
        <geometry s="4.5707963267948969e+01" x="4.0000000000000000e+01" y="3.0000000000000014e+01"
          hdg="-1.5707963267948966e+00" length="3.0000000000000036e+01">
          <line />
        </geometry>
        <geometry s="7.5707963267948998e+01" x="4.0000000000000000e+01" y="-2.1316282072803006e-14"
          hdg="-1.5707963267948966e+00" length="1.5707963267948974e+01">
          <arc curvature="-1.0000000000000001e-01" />
        </geometry>
        <geometry s="9.1415926535897967e+01" x="2.9999999999999993e+01" y="-1.0000000000000021e+01"
          hdg="-3.1415926535848278e+00" length="3.0000000000000014e+01">
          <line />
        </geometry>
        <geometry s="1.2141592653589798e+02" x="-4.9679432340866123e-11" y="-1.0000000000000000e+01"
          hdg="3.1415926535897922e+00" length="1.5707963267899299e+01">
          <arc curvature="-1.0000000000000001e-01" />
        </geometry>
        <geometry s="1.3712388980379728e+02" x="-1.0000000000000012e+01" y="0.0000000000000000e+00"
          hdg="1.5707963267998624e+00" length="3.0000000000000007e+01">
          <line />
        </geometry>
        <geometry s="1.6712388980379728e+02" x="-1.0000000000000000e+01" y="3.0000000000000007e+01"
          hdg="1.5707963267961380e+00" length="1.5707963267948967e+01">
          <arc curvature="-1.0000000000000001e-01" />
        </geometry>
      </planView>
      <lanes>
        <laneOffset s="0.0000000000000000e+00" a="0.0000000000000000e+00" b="0.0000000000000000e+00"
          c="0.0000000000000000e+00" d="0.0000000000000000e+00" />
        <laneSection s="0.0000000000000000e+00">
          <left>
            <lane id="1" type="none" level="false">
              <link>
              </link>
              <width sOffset="0.0000000000000000e+00" a="3.7500000000000000e+00"
                b="0.0000000000000000e+00" c="0.0000000000000000e+00" d="0.0000000000000000e+00" />
            </lane>
          </left>
          <center>
            <lane id="0" type="none" level="false">
              <link>
              </link>
            </lane>
          </center>
          <right>
            <lane id="-1" type="none" level="false">
              <link>
              </link>
              <width sOffset="0.0000000000000000e+00" a="3.7500000000000000e+00"
                b="0.0000000000000000e+00" c="0.0000000000000000e+00" d="0.0000000000000000e+00" />
            </lane>
          </right>
        </laneSection>
      </lanes>
    </road>
  </OpenDRIVE>
  ```

  ![image-20230212174248812](https://yrecord.oss-cn-hangzhou.aliyuncs.com/picture/202302121742935.png)