# 一、线

- 道路的走向可以（can）是多种多样的，它们可以是空旷地面上的直线、高速公路上细长的弯道、亦或山区狭窄的转弯。为从数学角度对所有这些道路线进行正确建模，OpenDRIVE提供了多种几何形状元素。 图19展示了五种定义道路参考线几何形状的可行方式

  ![image-20230206171459291](https://yrecord.oss-cn-hangzhou.aliyuncs.com/picture/202302061715692.png)

- 道路参考线是OpenDRIVE中每条道路的基本元素。所有描述道路形状以及其他属性的几何元素都依照参考线来定义，这些属性包括车道及标志。按照定义，参考线向s方向伸展，而物体出自参考线的侧向偏移，向t方向伸展

## 1.1 直线(line)

- line 标签表示直线元素
- s： 值表示该段几何线在参考线中的起始位置
- xy：值给出参考线起始位置在惯性坐标系下的位置
- heading： 该值给出起始朝向，用弧度表示
- ength：几何线的长度

  ```xml
  <planView>  # 参考线标签 
    <geometry
  	  s="0.0000000000000000e+00" 
  	  x="-4.7170752711170401e+01"
  	  y="7.2847983820912710e-01"
  	  hdg="6.5477882613167993e-01"
  	  length="5.7280000000000000e+01">
  	  <line/> # 描述其它属性的标签，这里表示是一条直线
      <arc curvature="-1.1494252873563220e-01"/> # 这里表示
    </geometry>
  </planView>
  ```

  

## 1.2 弧线(arc)

- 弧线的属性除了直线所有的一切以外还包括一个curvature弧度，因为弧线本身就是弧度恒定的曲线，这样通过上述属性我们就可以确定一个弧线了

## 1.3 螺旋线(spiral)

- 螺旋线特点是他是**弧度线性变化的曲线**，所以在包含所有直线的属性以外，还包含一curvStart和curvEnd属性，为线性变化的起始点和终止点
- 螺旋线是一条描述参考线变化曲率的回旋曲线。螺旋线可（may）被用来描述曲率在<line>到<arc>连贯的转换
- 螺旋线是以起始位置的曲率(@curvStart)和结束位置的曲率(@curvEnd)为特征。沿着螺旋线的弧形长度（见 `<geometry>` 元素@length），曲率从头至尾呈线性。也可以按顺序排列 `<line>` 、 `<spiral>` 和 `<arc>` 几个元素，从而对复杂曲率进行描述
- curvStart和@curvEnd不应该相同





# 二、道路参考线

- 道路参考线是OpenDRIVE中每条道路的基本元素。所有描述道路形状以及其他属性的几何元素都依照参考线来定义，这些属性包括车道及标志。按照定义，参考线向s方向伸展，而物体出自参考线的侧向偏移，向t方向伸展

- 在OpenDRIVE中，参考线的几何形状用<planView>元素里的 `<geometry>` 元素来表示。`<planView>` 元素是每个 `<road>` 元素里必须要用到的元素

- 标签属性

      <!-- 
                s 起始位置的s坐标
                x 起始位置的x坐标
                y 起始位置的y坐标
                hdg 起始方向(航向角/偏航角)
                length 元素的参考线长度
               -->

- 应用规则
  - 每条道路有且只有一条参考线。也就是`road`标签中，`planView` 标签只能且必须出现一次
  - 参考线通常在道路中心，但也可能有侧向偏移。
  - 几何元素应沿参考线以升序（即递增的s位置）排列。
  - 一个 `<geometry>` 元素应只包含一个另外说明道路几何形状的元素。(比如直线或者弧线)
  - 若两条道路不使用交叉口来连接，那么新的道路的参考线应总是起始于其前驱或后继道路的 `<contactPoint>` 。参考线有可能被指向相反方向。
  - 参考线不能有断口。
  - 参考线不应有扭结。

# 三、Road

- OpenDrive中的道路可以与真实路网中或为应用而设的路网中的道路相提并论。每条道路由一个或多个 `<road>` 元素描述

- 一个 `<road>` 元素可以覆盖一条长路、交叉口之间较短的路，或甚至多条道路

- 只有在道路的属性不能在先前 `<road>` 元素中得到描述或需要一个交叉口的情况下，才应开始一个新的 `<road>` 元素

  ```
  name： 道路名称，可以随意选择
  length： xy平面中参考线的总长度；无需考虑被高程影响的长度变化
  id: 唯一
  junction： 交叉口的ID，道路作为联接道路属于该交叉口（无（none）使用= -1）
  rule： 使用道路的基本规则； RHT =靠右行车，LHT =靠左行车。当缺少此属性时，将假定为RHT
  ```

  

## 3.1 道路段以及横截面属性

- 某些道路属性是基于**道路横截面得到描述**的，道路横截面是道路参考线上给定点处的道路正交视图。超高程是一种与道路横截面相关的属性。如果元素对道路横截面有效，那么它对道路参考线上给定点处的整个宽度都有效
- 其他道路属性是基于**道路平面图得到描述**的，其中包括车道和道路高程。这些属性称为道路段，其描述了道路的各个部分以及它们沿道路参考线s坐标的特定属性。对路段有效的属性仅对特定车道有效，可能对整个道路宽度无效。
- 这意味着可为不同属性（例如道路类型或车道段）创建不同的道路段，方式是使用新的起始s坐标以及 `<road>` 元素中的附加元素。两个给定s-起始位置之间的差别隐式地指定了组的长度。段的存储必须按s坐标升序来进行

## 3.2 道路链接

- 为了能够在路网中行进，道路必须相互连接。道路可以连接到其他道路或交叉口上（孤立的道路除外）

- 相互连接的道路的车道及其参考线需与其前驱以及后继道路的车道及其参考线直接连接

- 在OpenDRIVE中

  - 道路连接用 `<road>` 元素里的 `<link>` 元素来表示
  - `<predecessor>` 以及 `<successor>` 元素在 `<link>` 元素中被定义
  - 对于虚拟和常规的交叉口来说， `<predecessor>` 以及 `<successor>` 元素必须使用不同的属性组

- 如果道路与一条后继、前驱或相邻道路连接，该属性则遵循道路头文件。孤立的道路可忽略该元素

- 必须将不同属性用于虚拟以及常规的交叉口

  - @contactPoint须用于常规交叉口；

  - @elementS 和 @elementDir则须用于虚拟交叉口

    | **attributes** **属性** | **name** **名称** | **type** **类型**       | **unit** **单位** | **value** **值** | **Description** **描述**                                     |
    | ----------------------- | ----------------- | ----------------------- | ----------------- | ---------------- | ------------------------------------------------------------ |
    |                         | `elementId`       | string                  |                   |                  | 被连接的元素ID                                               |
    |                         | `elementType`     | e_road_link_elementType |                   | road ; junction  | 被连接的元素类型                                             |
    |                         | `contactPoint`    | e_contactPoint          |                   | start ; end      | 被连接元素中的链接接触点                                     |
    |                         | `elementS`        | t_grEqZero              | m                 |                  | "road"用于虚拟交叉口的接触点contactPoint的备选；标明了前驱中的联接，意为不在前驱的起点或终点。只能（shall）用于"road"元素类型 |
    |                         | `elementDir`      | e_elementDir            |                   | +;-              | .该属性将在用elementS定义联接时提供，它标明了道路进入的前面的道路的方向。 |

- 以下规则适用于道路连接:

  - 只有在连接清晰的情况下，才能直接连接两条道路。如果与前驱或后继的关系模糊，则必须使用交叉口。
  - 道路可将其他道路或交叉口作为其后继或前驱，它也可以没有后继或前驱(孤儿道路)
  - 道路亦可作为自身的后继或前驱。

## 3.3 道路类型

- 道路类型（例如高速公路以及乡村公路）定义了道路的主要用途以及相关的交通规则。道路类型对于整个道路横截面均有效

- 通过在沿参考线的给定点上定义不同道路类型，可在 `<road>` 元素中根据需要改变道路类型。道路类型将持续有效，直到另一个道路类型被定义

- 在OpenDRIVE中，道路类型用<road>元素中的 `<type>` 元素来表示。道路类型本身在@type属性中被给定

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述**                           |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | -------------------------------------------------- |
  |                         | `s`               | t_grEqZero        | m                 | [0;∞[            | 起始位置的s坐标                                    |
  |                         | `type`            | e_roadType        |                   |                  | 道路的国家/地区代号，参见ISO 3166-1，alpha-2代号。 |
  |                         | `country`         | e_countryCode     |                   |                  | 道路的国家/地区代号，参见ISO 3166-1，alpha-2代号。 |

- 以下规则适用于道路类型:

  - 当道路类型有变更时，必须（在父级<road>元素中创建一个新的 `<type>` 元素。
  - 可添加国家/地区代号以及州标识符至 `<type>` 元素中，以便对适用于该道路类型的国家交通规则进行详细说明。相关数据并不存储在OpenDRIVE中，它将存储于应用中。
  - 只能使用ALPHA-2 国家/地区代号，ALPHA-3 国家/地区代号不能得以使用，原因是只有ALPHA-2 国家/地区代号才支持州标识符。
  - 单独车道可能与其所属道路的类型不同。道路类型和车道类型代表不同的属性，若有具体说明，那么两种属性都为有效。

## 3.4 道路类型的限速

- 可为道路类型设置速度限制（限速）。若道路类型已更改且在路段中已有速度限制存在，由于道路类型并不拥有全局有效的速度限制，因此需要一个新的速度元素。必须为每个道路类型元素单独定义限速。

- 在OpenDRIVE中，速度限制用 `<type>` 元素里的 `<speed>` 元素来表示。该属性结合了特定的道路类型对默认的最大允许速度进行定义。

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值**             | **Description** **描述**               |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------------------- | -------------------------------------- |
  |                         | `max`             | t_maxSpeed        |                   | no limit ; undefined ; [0,∞[ | 起始位置的s坐标                        |
  |                         | `unit`            | e_unitSpeed       |                   |                              | 最大属性的单位。关于值，请参见"单位"。 |

- 以下规则适用于速度限制:
  - 最大速度可以被定义为每个道路类型元素的默认值。
  - 单独车道可以有不同于其所属道路的速度限制，其将被定义为<laneSpeed>。
  - 源自标志的限速必须始终被优先考虑。

## 3.5 高程

- 了解即可，map没有使用到3D坐标

## 3.6 道路表面

- penDRIVE并不包含对道路表面的描述，该类描述则包含在OpenCRG中，但OpenDRIVE可以引用在OpenCRG中生成的数据。两者均不包含有关道路表面视觉展示的数据。借助OpenCRG可以对更细节化的道路表面属性进行建模



# 四、车道

- 在OpenDRIVE中，所有道路都包含了车道。每条道路必须拥有至少一条宽度大于0的车道，并且每条道路的车道数量不受限制
- 需要**使用中心车道对OpenDRIVE中的车道进行定义和描述**。中心车道没有宽度，并被用作车道编号的参考，自身的车道编号为0。对其他车道的编号以中心车道为出发点：**车道编号向右呈降序，也就是朝负t方向；向左呈升序，也就是朝正t方向**
- 在OpenDRIVE中，车道用 `<road>` 元素里的 `<lanes>` 元素来表示
- 以下规则适用于车道的使用：
  - 每条道路必须拥有一条中心车道及一条宽度大于0的车道。
  - 道路可根据需要而设定任意数量的车道。
  - 中心车道不能拥有宽度，这就意味着不能（shall）将<width>元素用于中心车道。
  - 中心车道编号必须为0。
  - 车道编号必须在中心车道之后从1开始，朝负t方向为降序，朝正t方向为升序。
  - 车道编号必须保持连续性且无任何间断。
  - 每个车道段都必须有唯一的车道编号。
  - 可通过使用<lane>元素的@type属性对双向车道进行详细说明

## 4.1 在车道段中进行车道分组

- 为了能够便利地在OpenDRIVE道路描述中进行查找，一个车道段内的车道可分为左、中和右车道，车道在该组中用 `<lane>` 元素来描述。由于车道编号朝负t方向呈降序且朝正t方向呈升序，应用可（can）从ID属性中给出的车道编号中得知车道的方向（除非@type是双向的)
- 在OpenDRIVE中，车道组用 `<laneSection>` 元素内的 `<center>` 、 `<right>` 和 `<left>` 元素来表示。ID属性用嵌套在 `<center>` 、 `<right` 和 `<left>` 元素里的 `<lane>` 元素来定义
- 以下规则适用于车道分组：
  - 带有正ID的车道在中心车道的左侧，而带有负ID的车道则在中心车道的右侧。
  - 每个车道段必须（shall）包含至少一个<right>或<left>元素。
  - 必须（shall）给每个s坐标定义一个<center>元素。
  - 每个车道段都可（may）包含一个<center>元素。
  - 为了能够更好地确认方向，车道应（should）按照降序ID按从左到右的顺序排列。

## 4.2 车道段(laneSection)

- 车道可被分成多个段。每个车道段包含车道的一个固定编号。如图56所示，每次车道编号的变更都随之产生一个新车道段的需求。车道段的定义将沿道路参考线按升序来进行

- 为了能更轻易地在复杂道路上对车道段进行使用，可仅使用@singleSide属性对道路的一侧进行定义

- 车道可被分成多个段，每个车道段都包含一个车道的固定编号。每一次的车道编号变更都将需要定义一个新的车道段

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述**                                 |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | -------------------------------------------------------- |
  |                         | `s`               | t_grEqZero        | m                 | [0;∞[            | 起始位置的s坐标                                          |
  |                         | `singleSide`      | t_bool            |                   | true ; false     | 车道段元素仅对一侧有效（左、中或右），这将取决于子元素。 |

- 为了能够便利地在OpenDRIVE的道路描述中进行查找，一个车道段内的车道可分为左、中和右车道。每个车道段均必须（shall）包含一个<center>元素和至少一个<right>或<left>元素

- 车道元素被包括在左/中/右元素中。车道元素必须（should）使用降序ID从左到右展示车道

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述** |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | ------------------------ |
  |                         | `id`              | integer           |                   | [-∞;∞[           | 车道的ID                 |

- 为了能够便利地在OpenDRIVE的道路描述中进行查找，一个车道段内的车道可分为左、中和右车道。每个车道段均必须（shall）包含一个<center>元素和至少一个<right>或<left>元素

- 车道元素被包括在左/中/右元素中。车道元素必须（should）使用降序ID从左到右展示车道

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述** |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | ------------------------ |
  |                         | `id`              | integer           |                   | [-∞;∞[           | ID of the lane车道的ID   |

- 以下规则适用于车道段：
  - 每条道路都必须拥有至少一个车道段。
  - 车道段必须按升序来定义。
  - 每个s位置上都必须只有一条中心车道。
  - 应该避免在长距离上使用宽度为0的车道。
  - 每次车道编号改变都必须有新的车道段被定义。
  - 车道段将持续有效，直到一个新的车道段被定义。
  - 可根据需要多次更改一个车道段内的车道属性。
  - 可仅使用@singleSide属性为道路的一侧对车道段进行定义。

## 4.3 车道偏移

- 车道偏移可用于将中心车道从道路参考线上位移，以便能够更轻松地在道路上对车道的局部横向位移进行建模（比如对左转车道进行建模)

- 根据用于车道偏移的插值，车道偏移和形状定义两者的组合可导致不一致性。若线性插值被用于定义沿参考线的道路形状，那么它也应被用于偏移定义，以便两者的定义能被一致地组合使用

- 在OpenDRIVE中，车道偏移用<lanes>元素内的<laneOffset>元素来表示

- 车道偏移可（may）用于将中心车道从道路参考线上位移

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述**                                     |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | ------------------------------------------------------------ |
  |                         | `s`               | t_grEqZero        | m                 | [0;∞[            | s-coordinate of start positions坐标的起始位置                |
  |                         | `a`               | double            | m                 | ]-∞;∞[           | Polynom parameter a, offset at @s (ds=0)多项式参数a, 在@s (ds=0)处偏移 |
  |                         | `b`               | double            | 1                 | ]-∞;∞[           | Polynom parameter d多项式参数 d                              |
  |                         | `c`               | double            | 1/m               | ]-∞;∞[           | Polynom parameter c多项式参数 c                              |
  |                         | `d`               | double            | 1/m²              | ]-∞;∞[           | Polynom parameter d多项式参数 d                              |

- 计算方式
  - 利用以下三阶多项式函数来计算给定点的偏移：offset (ds) = a + b*ds + c*ds² + d*ds³
    - 其中offset是在给定点处的横向偏移，a, b, c, d是系数，ds是新的道路偏移元素起始处和给定位置之间沿道路参考线产生的距离
  - 每当新的元素出现， `ds` 则清零。偏移值的绝对位置计算方式如下：s = sstart + ds
    -  其中s是参考线坐标系统中的绝对位置，sstart是参考线坐标系统中元素的起始位置
  - 每一次的多项式函数变更都需要一个新的车道偏移元素
- 以下规则适用于车道偏移：
  - 车道偏移不能与道路形状一同使用。
  - 当底层的多项式函数有变化时，必须启动一个新的车道偏移。
  - 若边界定义已存在，则不允许出现偏移

## 4.4 车道连接

- 车道的连接信息被存储在OpenDRIVE中以便进行车道查找，并将借助于每条车道的前驱以及后继信息来对连接进行描述。车道和交叉口均可作为车道的前驱和后继部分。车道可连接至相同或不同道路上的其他车道上。
- 在OpenDRIVE中，车道连接用<lane>元素里的<link>元素来表示。<predecessor>和<successor>元素在<link>元素内得到定义
- 前面的和后置车道信息为有着相同参考线的车道之间的连接提供了车道在前面的以及后置车道段中的ID。只有在车道在一个路口结束或不具有物理连接时，这一元素才可被删除
- 以下规则适用于车道连接：
  - 一条车道可拥有另外一条车道作为其前驱或后继。
  - 只有当两条车道的连接明确时，它们才能被连接。若与前驱或后继部分的关系比较模糊，则必须（shall）使用交叉口。
  - 若车道结束于一个路口内或没有任何连接，则必须删除 `<link>` 元素

## 4.5 车道属性

- 车道属性描述了车道的用途以及形状。每个车道段都定义了一条车道属性，该属性也可能在该车道段中有变化。如果没有特意为车道段定义一条属性，应用便可采用默认属性
- 车道属性的示例是车道宽度、车道边界和限速
- 以下规则适用于车道属性：
  - 车道属性的定义必须相对于相应车道段的起点来展开。
  - 直到另外一个同类型的车道属性得到定义或车道段结束，特定的车道属性都必须保持有效。
  - 相同类型的车道属性必须按升序定义。

### 4.5.1 车道宽度

- 车道的宽度是沿t坐标而定义的。车道的宽度有可能在车道段内产生变化

- 车道宽度与车道边界元素在相同的车道组内互相排斥。若宽度以及车道边界元素在OpenDRIVE文件中同时供车道段使用，那么应用必须使用元素提供的信息

- 在OpenDRIVE中，车道宽度由 `<lane>` 元素中的 `<width>` 元素来描述

- 车道的宽度必须在每个车道段里至少被定义一次。中心车道不能有宽度，也就意味着不能对中心车道使用 `<width>` 元素。车道的宽度都必须保持有效，直到一个新的宽度元素被定义或车道段结束

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述**                                     |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | ------------------------------------------------------------ |
  |                         | `s`               | t_grEqZero        | m                 | [0;∞[            | <width> 要相对于前驱<laneSection> 元素的位置的起始位置的s坐标 |
  |                         | `a`               | double            | m                 | ]-∞;∞[           | 多项式参数 a, 在@s (ds=0)处偏移                              |
  |                         | `b`               | double            | 1                 | ]-∞;∞[           | 多项式参数 d                                                 |
  |                         | `c`               | double            | 1/m               | ]-∞;∞[           | 多项式参数 c                                                 |
  |                         | `d`               | double            | 1/m²              | ]-∞;∞[           | 多项式参数 d                                                 |

- 计算方式
  - 利用以下三阶多项式函数来计算给定点的宽度：Width (ds) = a + b*ds + c*ds² + d*ds³
  - 其中width是给定点处的宽度，a,b,c,d是系数，ds是新的道路宽度元素起始处和给定位置之间沿道路参考线产生的距离
  - 每当新的元素出现， `ds` 则清零。宽度值的绝对位置计算方式如下：s = ssection + offsetstart + ds
    - 其中s是参考线坐标系统里的绝对位置
    - sSection是轨迹坐标系里前面的车道段元素的起始位置
    - offsetStart是相对于前面的车道段的元素的偏移
  - 以下规则适用于车道宽度：
    - 车道的宽度必须（shall）在每个车道段中至少被定义一次。
    - 必须（shall）为整个车道段的长度定义车道宽度。这意味着s=0必须（must）要有一个<width>元素。
    - 中心车道不能（shall）拥有宽度，也就是说不能对中心车道使用<width>元素。
    - 直到新的宽度元素被定义或者车道段结束，车道的宽度都（shall）保持有效。
    - 当多项式函数的变量发生改变时，新的宽度元素必须（shall）得到定义。
    - 每个车道段的多个宽度元素都必须（shall）按升序得到定义。
    - 不能（shall）在相同车道组里同时使用宽度元素以及边界元素

### 4.5.2 车道边界

- 车道边界是用来描述车道宽度的另一种方法，它并不会直接定义宽度，而是在独立于其内部边界参数的情况下，对车道的外部界限进行定义。根据上述情况，内车道也被定义为车道，该车道虽然与当前被定义的车道有着相同ID符号，但内车道的ID绝对值要更小

- 相比较对宽度进行详细说明而言，此类定义要更加地便利。尤其是在道路数据是源自于自动测量结果的情况下，该方式可以避免多个车道段被创建

- 车道宽度与车道边界元素在相同的车道组内互相排斥。若宽度以及车道边界元素在OpenDRIVE文件中同时供车道段使用，那么应用必须（must）使用 `<width>` 元素提供的信息

- 在OpenDRIVE中，车道边界用 `<lane>` 元素中的 `<border>` 元素来表示

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述**                                     |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | ------------------------------------------------------------ |
  |                         | `sOffset`         | t_grEqZero        | m                 | [0;∞[            | <width> 元素起始位置的s坐标, 相对于前面的 `<laneSection>` 元素的位置 |
  |                         | `a`               | double            | m                 | ]-∞;∞[           | 多项式参数 a, 在@s (ds=0)处偏移                              |
  |                         | `b`               | double            | 1                 | ]-∞;∞[           | 多项式参数 d                                                 |
  |                         | `c`               | double            | 1/m               | ]-∞;∞[           | 多项式参数 c                                                 |
  |                         | `d`               | double            | 1/m²              | ]-∞;∞[           | 多项式参数 d                                                 |

- 计算方式

  - 利用以下三阶多项式函数来计算给定点的边界位置：tborder (ds) = a + b*ds + c*ds² + d*ds³

  - 其中 s是参考线坐标系统中的绝对位置，sSection是轨迹坐标系中前驱车道段元素，offsetStart是相对于前驱车道段元素的元素的偏移

- 以下规则适用于车道边界：

  - 不能在相同车道组内一同使用宽度元素以及边界元素。
  - 边界元素不能和车道偏移同时存在。
  - 当多项式函数的变量发生改变时，必须要定义一个新的边界元素。

### 4.5.3 车道类型

- 每条车道都会被定义一个类型。车道类型定义了车道的主要用途及与其相对应的交通规则

- 可用的车道类型有：

  - **路肩shoulder**：描述了道路边缘的软边界。
  - **边界border**：描述了道路边缘的硬边界。其与正常可供行驶的车道拥有同样高度。
  - **驾驶driving**：描述了一条“正常”可供行驶、不属于其他类型的道路。
  - **停stop**：高速公路的硬路肩，用于紧急停车。
  - **无none**：描述了道路最远边缘处的空间，并无实际内容。其唯一用途是在（人类）驾驶员离开道路的情况下，让应用记录OpenDRIVE仍在运行。
  - **限制restricted**：描述了不应有车辆在上面行驶的车道。该车道与行车道拥有相同高度。通常会使用实线以及虚线来隔开这类车道。
  - **泊车parking**：描述了带停车位的车道。
  - **分隔带median**：描述了位于不同方向车道间的车道。在城市中通常用来分隔大型道路上不同方向的交通。
  - **自行车道biking**：描述了专为骑自行车者保留的车道。
  - **人行道sidewalk**：描述了允许行人在上面行走的道路。
  - **路缘curb**：描述了路缘石。路缘石与相邻的行车道在高度有所不同。
  - **出口exit**：描述了用于平行于主路路段的车道。主要用于减速。
  - **入口entry**：描述了用于平行于主路路段的车道。主要用于加速。
  - **加速车道onramp**：由乡村或城市道路引向高速公路的匝道。
  - **减速车道offRamp**：驶出高速公路，驶向乡村或城市道路所需的匝道。
  - **连接匝道connectingRamp**：连接两条高速公路的匝道。例如高速公路路口

- 车道元素元素被包括在左/中/右元素元素中。车道元素元素应按降序ID从左到右展示车道

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述**                                     |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | ------------------------------------------------------------ |
  |                         | `type`            | e_laneType        |                   |                  | 车道类型。关于值请见UML 模型。                               |
  |                         | `level`           | t_bool            |                   |                  | "真true" = 将车道保持在水平, 也就是说不要采用超高程; "伪false" = 对此车道采用超高程 (为默认设置, 若属性水平缺失时也可用) |

- 以下规则适用于车道类型：

  - 可通过使用新的车道段根据需要多次地更改车道类型。

### 4.5.4 车道材质(了解)

- 该属性存储了关于车道材质的信息。直到新的元素得到定义，每个元素都将保持有效。若有多个元素得到定义，它们必须按升序被排列

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述**                            |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | --------------------------------------------------- |
  |                         | `sOffset`         | t_grEqZero        | m                 | [0;∞[            | 起始位置的s坐标,相对于前面的<laneSection>元素的位置 |
  |                         | `surface`         | string            |                   |                  | 根据应用而定的表面材质代码                          |
  |                         | `friction`        | t_grEqZero        |                   | [0;∞[            | 摩擦力系数                                          |
  |                         | `roughness`       | t_grEqZero        |                   | [0;∞[            | 粗糙程度，例如形容声音以及运动系统                  |

- 以下规则适用于车道材质：
  - 中心车道不能（shall）拥有材质元素。
  - 直到另一材质元素得到启动或车道段结束，车道的材质元素都必须（shall）保持有效。
  - 若每个车道段都各自拥有多个材质元素，那么这些元素必须（shall）相对于s位置按升序得到定义。

### 4.5.5 车道限速

- 可对车道上允许的最大行驶速度进行定义，该车道限速随即将覆盖道路限速

- 在OpenDRIVE中，车道速度用<lane>元素内的<speed>元素来表示

- 该属性定义了给定车道上允许的最大行驶速度。直到新的元素得到定义，每个元素都在s坐标的增长方向中继续有效

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述**                                   |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | ---------------------------------------------------------- |
  |                         | `sOffset`         | t_grEqZero        | m                 | [0;∞[            | element起始位置的s坐标, 相对于先前<laneSection> 元素的位置 |
  |                         | `max`             | t_grEqZero        | m/s               | [0;∞[            | 最大允许速度                                               |
  |                         | `unit`            | e_unitSpeed       |                   |                  | 属性的单位。关于值请参见UML 模型                           |

- 以下规则适用于车道限速：
  - 中心车道不能拥有任何限速。
  - 除非有另一个限速得到定义或车道段结束，车道的限速都必须保持有效。
  - 若每个车道段都拥有多个车道限速元素，那么这些元素必须按升序得到定义。
  - 源自于标志的限速必须始终被优先考虑

### 4.5.6 车道的使用

- 车道可局限于特定的道路使用者，例如卡车或公共汽车。这类限制可在道路标识描述的限制之上另外在OpenDRIVE中得到定义

- OpenDRIVE在 `<lane>` 元素内提供了 `<access>` 元素，以便描述车道使用规则

- 该属性定义了针对特定道路使用者类型的车道使用限制

- 每个元素在s坐标的增长方向中都是有效的，直到新的元素得到定义。若多个元素得到定义，那它们必须（must）按升序得到排列

  | **attributes** **属性** | **name** **名称** | **type** **类型**                            | **unit** **单位** | **value** **值** | **Description** **描述**                                     |
  | ----------------------- | ----------------- | -------------------------------------------- | ----------------- | ---------------- | ------------------------------------------------------------ |
  |                         | `sOffset`         | t_grEqZero                                   | m                 | [0;∞[            | 起始位置的s坐标,相对于前驱 `<laneSection>` 元素的位置        |
  |                         | `rule`            | e_road_lanes_laneSection_lr_lane_access_rule |                   |                  | 详细说明了在@restriction属性中指定的参与者是否可以使用已知车道 |
  |                         | `restriction`     | e_accessRestrictionType                      |                   |                  | 限制所针对参与者的标识符。关于值, 请参见 UML 模型            |

- 以下规则适用于车道使用规则：
  - 中心车道不能拥有使用规则。
  - 直到另一条使用规则得到定义或车道段结束，使用规则都必须保持有效。
  - 若每个车道段都拥有多个使用规则元素，那么这些元素必须按升序得到定义。
  - 车道使用元素可在相同偏移位置开始。
  - 若一个车道元素内无 `<access>` 元素存在，则也没有使用限制。
  - 若 `<rule>` 元素里出现否定值，那么所有其他车辆仍被允许使用车道。
  - 若 `<rule>` 元素里出现允许值，那么所有其他车辆则被禁止使用车道。
  - 只能为给定s位置赋予否定值或允许值的其中一个，二者不能同时出现。
  - 即便只有一个子集被改变，都必须为所有限制重新定义一个新的s位置。
  - 否定=无 deny=none 这个限制被用于恢复所有先前限制。

### 4.5.6 车道高度

- 车道高度必须沿h坐标得到定义。无关于道路高程，车道高度可用于标高车道。车道高度用于执行如图71所示的小规模高程，该图展示了人行通道如何通过车道高度被拔高。车道高度被认为是偏离道路并朝z方向的偏移（包括高程、超高程和形状）。

- 在OpenDRIVE中，车道高度用<lane>元素内的<height>元素来表示

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述**                           |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | -------------------------------------------------- |
  |                         | `sOffset`         | t_grEqZero        | m                 | [0;∞[            | 起始位置的s坐标,相对于前驱<laneSection> 元素的位置 |
  |                         | `inner`           | double            | m                 | ]-∞;∞[           | 道路水平的内偏移                                   |
  |                         | `outer`           | double            | m                 | ]-∞;∞[           | 道路水平的外偏移                                   |

- 以下规则适用于车道高度：
  - 必须使用元素<height>来修改例如路缘石等物体的车道高度。
  - 中心车道不能被车道高度标高。
  - 车道高度不能用于定义道路高程或超高程。
  - 车道高度仅能在小规模高程中使用

### 4.5.7 从道路超高程中排除车道

- 单独的车道可从超高程中被排除，以便覆盖如带路缘石和边界的道路或无超高程的人行道等情况
- OpenDRIVE提供的属性@level用于将车道从道路超高程中排除出去。当车道的属性设为真（TRUE），那么该车道将会被道路的超高程和道路形状定义排除。车道的高程则与内侧连接车道的高度保持一致
- 多个外侧车道的水平可能为真（level=TRUE），例如一条人行道之后紧跟着的是一条自行车道
- 以下规格适用于将车道从道路高程中排除：
  - 如果一条车道有@level = TRUE这条属性，那么必须（shall）至少在一侧只有@level = TRUE的车道存在，直至到达道路边缘。
  - 可出现多条@level = TRUE的外车道。

## 4.6 道路标识

- 道路上的车道可拥有不同的车道标识，比如不同颜色和样式的线。OpenDRIVE为路标提供了 `<roadMark>` 元素。路标信息定义了车道外边界上的线的样式，在左车道上则为左边界，在右车道则为右边界。而作为分隔左右车道的中心线的样式则由中心车道路标元素来确定

- 可为道路横断面内的每一条车道定义多个路标元素。也可使用多个属性（如@type, @weight和 @width）来描述车道标志的属性

- 有两种规定路标类型的方法：

  - 通过<roadMark>元素内的@type属性可以输入存储在应用内的关键词。这些关键词被用于描述简化的路标类型如实线、虚线或草地。
  - <type>元素包含了更多<line>元素，这些元素将对路标进行更详细的描述。

- 在OpenDRIVE中，路标用 `<lane>` 元素内的 `<roadMark>` 元素来表示。

- 每一个类型的定义都必须（shall）包含一个或多个线条定义，此类定义带有关于线条（路标由此类线条组成）的附加信息

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述**                                     |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | ------------------------------------------------------------ |
  |                         | `name`            | string            |                   |                  | 路标类型名称； 可自由选择。                                  |
  |                         | `width`           | t_grEqZero        | m                 | [0;∞[            | 路标的累积宽度。若出现多个 `<line>` 元素，该 @width 为 `<line>` 元素的所有@width的总和以及路标形成所需的空间。该属性取代了 `<roadMark>` 元素中的定义。 |

- 路标可由一个或多个元素组成，而多个元素通常会被并排放置。线条定义对一条给定的车道长度有效且会被自动重复利用

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值**          | **Description** **描述**                                     |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ------------------------- | ------------------------------------------------------------ |
  |                         | `length`          | t_grEqZero        | m                 | [0;∞[                     | 可见部分的长度                                               |
  |                         | `space`           | t_grEqZero        | m                 | [0;∞[                     | 可见部分之间空隙的长度                                       |
  |                         | `tOffset`         | double            | m                 | [-∞;∞[                    | 自车道边界起的横向偏移。 若出现<sway> 元素, 那么横向偏移则跟随横向偏移曲线（sway）。 |
  |                         | `sOffset`         | t_grEqZero        | m                 | [0;∞[                     | 线条定义从路标定义起点开始的纵向偏移。                       |
  |                         | `rule`            | e_roadMarkRule    |                   | no passing; caution; none | .由内向外穿越界限时（如由较低绝对ID车道到较高绝对ID车道）必须（must）注意的规则。关于值请看UML模型。 |
  |                         | `width`           | t_grEqZero        | m                 | [0;∞[                     | Line width线的宽度                                           |
  |                         | `color`           | e_roadMarkColor   |                   |                           | 线的颜色. 若颜色被给定, 该属性取代 `<roadMark>` 元素里的定义。关于值请看UML模型。 |

- 以下规则适用于路标：
  - <roadMark>元素只能（shall）用于描述外侧路标。
  - 必须（shall）按照一定方式将车道线标志的中心线置于车道的外侧边界线，并使车道线标志的外半侧从物理角度上被置于下一条车道上

### 4.6.1路标类型和线条

- 关于路标类型和线条的详细信息可（may）在<roadMark>元素内的 `<type>` 元素里得到定义。每个<type>定义包含一个或多个有路标线条附加信息的 `<line>` 定义

- `<type>` 元素里的路标信息比 `<roadMark>` 元素内@type属性中给出的要更加具体。

- 通过属性@length和@space对路标的概况进行描述：

  - @length代表了线条的可见部分。
  - @space描述了不可见部分。

- 可通过定义横向偏移对路标进行描述。线条定义对车道给定的长度有效并自动会被重复使用。线条的可选@rule属性定义了从内部穿过车道的交通规则。在OpenDRIVE中，路标类型及线条用 `<roadmark>` 元素内的 `<type>` 元素来表示。线条定义被包含在 `<type>` 元素内的 `<line>` 元素中

- 该属性定义了车道外边界线条的样式。而分隔左右车道的中心线的样式由专为中心车道而设的路标元素来确定

  | **attributes** **属性** | **name** **名称** | **type** **类型**                                      | **unit** **单位** | **value** **值**               | **Description** **描述**                                     |
  | ----------------------- | ----------------- | ------------------------------------------------------ | ----------------- | ------------------------------ | ------------------------------------------------------------ |
  |                         | `sOffset`         | t_grEqZero                                             | m                 | [0;∞[                          | 元素起始位置的s坐标, 相对于先前 `<laneSection>` 元素的位置。 |
  |                         | `type`            | e_roadMarkType                                         |                   |                                | 路标类型。关于值请看UML模型。                                |
  |                         | `weight`          | e_roadMarkWeight                                       |                   |                                | 路标粗细。若下面给出了详细定义，则该属性可作为可选项。关于值请看UML模型。 |
  |                         | `color`           | e_roadMarkColor                                        |                   |                                | 路标颜色。关于值请看UML模型。                                |
  |                         | `material`        | string                                                 |                   |                                | 路标材质. 由用户自定义的标识符。用"standard"作为其默认值。   |
  |                         | `width`           | t_grEqZero                                             | m                 | [0;∞[                          | `<line>` element.路标宽度。若<line>元素里给出了详细定义，则该属性可作为可选项。 |
  |                         | `laneChange`      | e_road_lanes_laneSection_lcr_ lane_roadMark_laneChange |                   | increase; decrease; both; none | 考虑到车道按照升序从右到左被编号，该属性可使车辆朝指定方向变道。若属性缺失，则选用“both”作为默认值。关于值请看UML模型。 |
  |                         | `height`          | double                                                 | m                 | [-∞;∞[                         | 道路上路标的高度, 例如路标的厚度。                           |

### 4.6.2 显性路标类型和线条

- 当不规则路标不能被可重复的线条图案所描述时，可（may）用自定义的路标元素对其进行描述。这些显性的定义也包含了线条定义的 `<line>` 元素，但需要知道的是，这些线条并不能像在重复的路标类型的情况中那样被自动重复利用。在OpenDRIVE中，不规则路标类型和线条用 `<roadmark>` 元素内的 `<explicit>` 元素来表示。线条定义被包含在 `<explicit>` 元素内的 `<line>` 元素中

- `<explicit>` 元素应该被特别用于测量数据

- 该属性详细说明了一条显性路标定义中的单独的线条

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值**          | **Description** **描述**                                     |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ------------------------- | ------------------------------------------------------------ |
  |                         | `length`          | t_grEqZero        | m                 | [0;∞[                     | 可见线条的长度                                               |
  |                         | `tOffset`         | double            | m                 | [-∞;∞[                    | L自车道边界起的横向偏移。若出现<sway> 元素, 那么横向偏移则跟随横向偏移曲线（sway）。 |
  |                         | `sOffset`         | t_grEqZero        | m                 | [0;∞[                     | I线条定义从路标定义起点开始的纵向偏移。                      |
  |                         | `rule`            | e_roadMarkRule    |                   | no passing; caution; none | 由内向外穿越界限时（如由较低绝对ID车道到较高绝对ID车道）必须（must）注意的规则。关于值请看UML模型。 |
  |                         | `width`           | t_grEqZero        | m                 | [0;∞[                     | `<roadMark>` element.线条宽度。该属性取代<roadMark>元素里的定义。 |

- 该属性可使用物体的显性有效性信息来替换默认有效性。每个物体可定义多个有效性元素

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述**                                     |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | ------------------------------------------------------------ |
  |                         | `fromLane`        | integer           |                   | [-∞;∞[           | Minimum ID of the lanes for which the object is valid物体所针对有效的车道最小ID |
  |                         | `toLane`          | integer           |                   | [-∞;∞[           | Maximum ID of the lanes for which the object is valid物体所针对有效的车道最大ID |

### 4.6.3 路标偏移

- 可使用元素来描述非直线但有侧边曲线的车道标志。 `<sway>` 元素为以下的（显性）类型定义转移了横向参考位置，从而定义了一个偏移。横向偏移曲线偏移将相对于车道标识的名义参考位置，即车道边界

- 横向曲线的主要应用案例为创建穿过施工现场的道路。行车道在黄线之间，白线被横向偏移（swayed），并只作为标志存在

- 由横向参考位置而来的偏移在 `<roadMark>` 元素内的 `<sway>` 元素中得到定义

- 该属性针对以下（显性）类型定义对横向参考位置进行了转移，从而定义了一个偏移。横向偏移曲线（sway）偏移将相对于车道标识的名义参考位置，即车道边界

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述**                                     |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | ------------------------------------------------------------ |
  |                         | `ds`              | t_grEqZero        | m                 | [0;∞[            | s-coordinate of start position of the `<sway>` element, relative to the @sOffset given in the `<roadMark>` element<sway> 元素起始位置的s坐标,相对于 <roadMark> 元素里给出的@sOffset属性。 |
  |                         | `a`               | double            | m                 | ]-∞;∞[           | Polynom parameter a, sway value at @s (ds=0)多项式参数a, 在 @s (ds=0)处的横向偏移值 |
  |                         | `b`               | double            | 1                 | ]-∞;∞[           | Polynom parameter d多项式参数d                               |
  |                         | `c`               | double            | 1/m               | ]-∞;∞[           | Polynom parameter c多项式参数c                               |
  |                         | `d`               | double            | 1/m²              | ]-∞;∞[           | Polynom parameter d多项式参数d                               |

- 计算方式
  - 关于横向偏移的定义，用以下三阶多项式函数来计算给定点的横向参考位置：tOffset (ds) = a + b*ds + c*ds² + d*ds³
  - 其中 tOffset是在给定ds位置上从车道边界得到的横向参考位置的横向偏移，a, b, c, d 是系数，ds是元素起点和给定位置之间沿参考线产生的距离
  - 每当新的元素出现，ds则清零并相对于 `<roadMark>` 元素中给定的 `sOffset` 值存在

### 4.6.3 特定车道规则

- 可以为OpenDRIVE标准中未明确定义并将存储在所用应用程序中的特定车道定义特殊规则。在OpenDRIVE中，车道规则用<lane>元素中的<rule>元素来表示

- 该属性用于添加本说明文档中所有其他车道属性都没有涵盖的规则

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述**                                     |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | ------------------------------------------------------------ |
  |                         | `sOffset`         | t_grEqZero        | m                 | [0;∞[            | 起点位置的s坐标，相对于前驱<laneSection> 元素的位置          |
  |                         | `value`           | string            |                   |                  | 自由文本;当前推荐值有: "no stopping at any time" "disabled parking" "car pool |

- 以下规则适用于车道规则：
  - 应用可拥有仅对相应的应用有效、但在OpenDRIVE中无效的特别车道规则。

# 五、交叉路口

- 交叉口指的是三条或更多道路相聚的地方，与其相关的道路被分为两种类型（如图74所示）：含有驶向交叉口车道的道路称为来路

- 联接道路：呈现了穿过交叉口的路径

- 在OpenDRIVE中，交叉口用 `<junction>` 元素来表示。联接道路则用 `<junction>` 元素中的 `<connection>` 元素来表示。OpenDRIVE并未特意将去路定义为元素或属性，来路也可被视作为去路，因此二者在此处可被相提并论。通往该道路的联接道路将此类道路隐性地定义为去路

- 该属性包含了道路在一个物理交叉口上所有可能的联接方式

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述**                                     |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | ------------------------------------------------------------ |
  |                         | `name`            | string            |                   |                  | 交叉口的名称；可随意选择。                                   |
  |                         | `id`              | tstring           |                   |                  | ID中的唯一性ID                                               |
  |                         | `type`            | e_junction_type   |                   | default; virtual | 交叉口的类型；常规交叉口的类型为"默认"。属性对虚拟交叉口来说是必要的。 |

- 以下规则适用于车道规则:
  - 只有在道路不能被直接连接的情况下，交叉口才能得以使用。若一条道路拥有两条或以上可能的前驱或后继道路，这将导致二义性出现。而此时交叉口便会为连接清除二义性。
  - 与道路不同，交叉口并不具备任何前驱或后继交叉口。
  - 交叉口可拥有自己的名称，以便将自身与其他交叉口区分开来。
  - 如果只有两条道路相汇，那么便不应该（should）使用交叉口

## 5.1 来路

- 来路包含了通向交叉口的车道。由于OpenDRIVE并没有特别定义去路，因此来路也可被视为去路

- 为能详细说明一条作为来路的道路，将通过在 `<connection>` 元素中使用@incomingRoad属性来引用该道路的ID

- 该属性包含了道路在一个物理交叉口上所有可能的联接方式

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述**                                     |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | ------------------------------------------------------------ |
  |                         | `id`              | tstring           |                   |                  | 数据库中databaseUnique ID中的唯一性ID                        |
  |                         | `type`            | e_junction_type   |                   | default; virtual | 交叉口的类型；常规交叉口的类型为"默认"。属性对虚拟交叉口来说是必要的。 |
  |                         | `incomingRoad`    | string            |                   |                  | 来路的ID                                                     |
  |                         | `connectingRoad`  | string            |                   |                  | 联接道路的ID                                                 |
  |                         | `contactPoint`    | e_contactPoint    |                   | start; end       | 联接道路的接触点；值参见UML模式                              |

- 该属性提供了关于在一条来路和一条联接道路之间被连接的车道信息。强烈建议使用该元素。忽略<laneLink> 元素的做法已经不符合时宜

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述** |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | ------------------------ |
  |                         | `from`            | integer           |                   |                  | 来路车道的ID             |
  |                         | `to`              | integer           |                   |                  | 联接车道的ID             |

- 以下规则适用于来路:
  - 如果来路拥有驶离交叉口的车道，其也可被视作为去路。
  - 联接道路不能作为来路。

## 5.2 联接道路

- 联接道路会对在交叉口相遇的道路进行连接。该道路描述了车辆穿过一个交叉口的路线。联接道路的建模与标准道路相同
- 联接道路将基于其车道对路线进行描述。联接道路详细说明了相同交叉口的来路和去路的车道之间的连接。如果该车道并没有被连接，就意味着这些车道之间的路线不通
- 以下规则适用于联接道路:
  - 每条联接道路都必须只由一个 <connection>元素代表。一条联接道路拥有的车道数量可以根据需要而定。
  - 一条有着多车道的来路可以通过不同方式被连接到所属正在驶离交叉口的道路的车道:
    - 在有多条联接道路的情况下，若每条都有一个用于联接两条特定车道的<laneLink>元素，那么在该交叉口中进行变道是不可行的。
    - 若一条联接道路有多个用于两条特定车道连接的 `<laneLink>` 元素，则在该交叉口中变道是可行的。
  - 被连接车道必须如描述一样与道路平滑地相切合。
  - 可以为特定车辆（例如公交车）预留联接道路

### 5.2.1 交叉口中联接道路的优先级

- 如果一条来路借助多条联接道路被连接到一条正在驶离交叉口的道路，以便呈现几种可能的车道连接，那么其中一种连接可）被优先考虑。只有在应用无法从交叉口前或交叉口内的标志、或正驶入交叉口的车道中得出优先级时，才需要对其进行分配。

- `<priority>` 元素用于将优先级分配到联接道路。可能的属性为@high 和 @low

- 如果一条来路借助多条联接道路被连接到一条去路，以便呈现多种可能的车道连接，那么其中一种连接可被优先考虑，必须给定至少一个属性

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述** |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | ------------------------ |
  |                         | `high`            | string            |                   |                  | 优先级高的联接道路ID     |
  |                         | `low`             | string            |                   |                  | 优先级较低的联接道路ID   |

- 以下规则适用于交叉口内联接道路的优先级:
  - 只能在没有标志的情况下使用优先级元素。

### 5.2.2 联接道路的方向

- 一个交叉口的联接道路可能有多个方向。在驾驶方向是唯一的情况下，为易于使用，联接道路的参考线应该被置于驾驶方向内。
- 以下规则适用于联接道路的方向:
  - "start"值必须（shall）用于标明联接道路正在沿<laneLink>元素中的连接延伸。
  - "end"值必须（shall）用于标明联接道路正在沿<laneLink>元素中的连接的反方向延伸

## 5.3 交叉口内的道路表面

- 通过对应OpenCRG中使用的描述来对路面进行描述，道路可在交叉口被标高。可使用路面对交叉口内复杂的高程进行描述，其中包括重叠的道路。所有现存交叉口内道路高程的描述被<surface>元素所取代。由于OpenDRIVE不包含OpenCRG，因此本详细说明不对<surface>元素进行描述

- 该属性用于描述交叉口内的道路高程概况。当<junction>元素包含了一个<surface>元素时，后者则取代所有用于联接道路的高程数据

- OpenCRG里描述的数据用<surface>元素中的<CRG>元素来表示

  | **attributes** **属性** | **name** **名称** | **type** **类型**          | **unit** **单位** | **value** **值**    | **Description** **描述**                                     |
  | ----------------------- | ----------------- | -------------------------- | ----------------- | ------------------- | ------------------------------------------------------------ |
  |                         | file              | string                     |                   |                     | 包含CRG数据的文件名称                                        |
  |                         | mode              | e_road_surface_CRG_mode    |                   | global              | 用于路面数据的附件模式，详情见详细说明。                     |
  |                         | purpose           | e_road_surface_CRG_purpose |                   | elevation; friction | CRG文件包含了数据的物理用途；如果属性缺失，数据将作为高程数据。 |
  |                         | zOffset           | double                     | m                 | ]-∞;∞[              | CRG中心线和惯性xy-平面（默认=0.0）之间的z-偏移               |
  |                         | zScale            | double                     |                   | ]-∞;∞[              | 用于路面描述的z-比例因子（默认=1.0）的                       |

- *道路表面的CRG模式元素的属性*

  |                         |                   |                   |                   |                  |                          |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | ------------------------ |
  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述** |
  |                         | `attached`        | string            |                   |                  |                          |
  |                         | `attached0`       | string            |                   |                  |                          |
  |                         | `genuine`         | string            |                   |                  |                          |
  |                         | `global`          | string            |                   |                  |                          |

- *CRG用途的路面属性*

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述**                |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | --------------------------------------- |
  |                         | `elevation`       | string            |                   |                  | 对被连接的CRG文件是否包含高程值进行定义 |
  |                         | `friction`        | string            |                   |                  | 对被连接的CRG文件是否包含摩擦值进行定义 |

## 5.4 虚拟交叉口

- 虚拟交叉口用于描述道路中的联接，这类联接不要求像在一般交叉口一样去分拆主路。因此，虚拟交叉口可更轻易地被放置，其只应用于通往停车场以及住宅区的车道上

- 虚拟交叉口用 `<junction>` 元素以及@type属性进行建模

- 该属性提供了关于虚拟连接的前驱/后继道路的详细信息。当前只允许使用@elementType "road"这个属性

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述**                     |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | -------------------------------------------- |
  |                         | `elementType`     | string            |                   | road             | 被连接元素的类型；当前只有"road"被允许。     |
  |                         | `elementId`       | string            |                   |                  | 被连接元素的ID                               |
  |                         | `elementS`        | t_grZero          |                   | [0;∞[            | 联接道路与前驱/后继道路相遇的s坐标           |
  |                         | `elementDir`      | e_elementDir      |                   | +; -             | 相对于s方向的、位于前驱/后继道路上的联接方向 |

- 以下规则适用于虚拟交叉口:
  - 虚拟交叉口中的主要来路不需要在到达交叉口区域前结束。
  - 虚拟交叉口不能取代常规交叉口以及连接多条常规道路的交叉口。
  - 虚拟交叉口仅能用于主要道路的分支，主要道路永远拥有较高优先级。
  - 虚拟交叉口不能配备控制器，因此它没有任何交通灯。
  - 如果没有任何来路被定义，@incomingRoad这个属性则值为-1。

### 5.4.1 虚拟连接

- 虚拟连接标明了两条道路或它们中一条或多条车道之间可能的连接。由于被标识的连接是虚拟的，因此没有任何真实路线可得到定义。这意味着参考线的路线不会被改变
- 虚拟连接描述了道路与车道之间的拓扑连接，它不需要在几何层面上正确。该特性作为便捷函数被执行，以便OpenDRIVE对初学者来说更容易上手
- 虚拟连接由<junction>元素中的@type属性来建模
- <connection> 元素中的 <predecessor> 以及<successor> 元素描述了虚拟连接的前驱以及后继的道路
- 以下规则适用于虚拟连接:
  - 虚拟连接不能（shall not）取代由道路以及车道连接来描述的常规几何元素。
  - 虚拟连接只能（shall）在虚拟道路中被定义

## 5.5 交叉口组

- 交叉口组是通过 `<junctionGroup>` 元素来描述的。所属交叉口组的交叉口由 `<junctionReference>` 元素来详细说明

- 可将两个或以上的交叉口分到交叉口组中，以标明这些交叉口属于同一个环岛

- `<junctionGroup>` 元素将被拆分到一个头文件元素或一系列成员元素中

  | **attributes** **属性** | **name** **名称** | **type** **类型**    | **unit** **单位** | **value** **值**    | **Description** **描述**                   |
  | ----------------------- | ----------------- | -------------------- | ----------------- | ------------------- | ------------------------------------------ |
  |                         | `name`            | string               |                   | road                | 交叉口组的名称，可（may）随意选择。        |
  |                         | `id`              | string               |                   |                     | 在数据库中是唯一的。                       |
  |                         | `type`            | e_junctionGroup_type |                   | roundabout; unknown | l交叉口组的类型。关于值的详情参见UML模型。 |

- 对现有的交叉口元素进行引用

  | **attributes** **属性** | **name** **名称** | **type** **类型** | **unit** **单位** | **value** **值** | **Description** **描述**     |
  | ----------------------- | ----------------- | ----------------- | ----------------- | ---------------- | ---------------------------- |
  |                         | `junction`        | string            |                   | road             | ID of the junction交叉口的ID |

### 5.5.1 用于交叉口的控制器

- 控制器可用于管理交叉口内的标志。关于控制器的使用参见标志章节。 `<junction>` 元素中的元素功能在于罗列已有控制器并根据其他交叉口内的控制器对其进行优先级排列

- 用于交叉口的控制器由 `<junction>` 元素中的 `<controller>` 元素进行描述

- 该属性罗列了用于管理交叉口的控制器

  | **attributes** **属性** | **name** **名称** | **type** **类型**  | **unit** **单位** | **value** **值** | **Description** **描述**                               |
  | ----------------------- | ----------------- | ------------------ | ----------------- | ---------------- | ------------------------------------------------------ |
  |                         | `id`              | string             |                   |                  | 控制器的ID                                             |
  |                         | `type`            | string             |                   |                  | 用于交叉口的控制器类型。自由文本，根据应用而定。       |
  |                         | `sequence`        | nonNegativeInteger |                   | [0;∞[            | 该控制器相对于同交叉口内其他控制器的顺序编号（优先级） |
