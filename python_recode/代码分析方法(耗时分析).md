[ck](https://www.machinelearningplus.com/python/cprofile-how-to-profile-your-python-code/)

- 编写方法

  ```python
  import cProfile, pstats
  
  pr = cProfile.Profile()
  pr.enable()
  # do something
  pr.disable()
  
  # 对结果进行分析
  stats = pstats.Stats(pr)
  stats.sort_stats(pstats.SortKey.TIME) # 排序
  stats.print_stats()
  # stats.dump_stats(filename='') 写入到文件之中
  
  snakeviz filename # 可视化分析结果
  ```

  

- 参数含义

  ```python
  cProfile参数含义：
  
  ncalls：表示函数调用的次数；
  
  tottime：表示指定函数的总的运行时间，********除掉函数中调用子函数的运行时间*******；
  percall：（第一个percall）等于 tottime/ncalls；
  
  cumtime：表示该函数及其所有子函数的调用运行的时间，*****即函数开始调用到返回的时间********； 
  percall：（第二个percall）即函数运行一次的平均时间，等于 cumtime/ncalls； 
  
  filename:lineno(function)：每个函数调用的具体信息；
  
  ```




# 二、分析技巧

- [link](https://cloud.tencent.com/developer/article/2066077?from=15425)
- [snakeViz](https://jiffyclub.github.io/snakeviz/)

![image-20230626170659620](https://yrecord.oss-cn-hangzhou.aliyuncs.com/picture/202306261707449.png)



# 三、杂记

- **pstats简介**
  - `pstats`模块是Python的性能分析器，它使用`cProfile`来统计代码的运行时间，并生成相应的统计结果。这些结果可以帮助开发者找出程序中耗时较多的部分，从而有针对性地进行优化。`pstats`提供了一个类`Stats`，该类可以加载并解析`cProfile`生成的统计文件，并提供了多种方法用于查看分析结果