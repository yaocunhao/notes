[参考链接](https://zhuanlan.zhihu.com/p/401431006)



# 序列化

- pickle 进行数据序列化时，需要序列化的对象属性参数是由__dict__提供的，也就是说在序列化对象的时候，会返回对象的所有参数
  此时，可以使用魔法方法来对序列化的参数进行修改

- `__getstate__`，pickle进行序列化时会自动调用，该函数的返回值就是序列化的内容

- ` __setattr__`,pickle 反序列化时，会调用该函数给对象的属性字段进行赋值

  ```python
  
  class Demo:
  
    # 两个参数
    def __init__(self, name, age):
      self.name = name
      self.age = age
  
    # pickle 序列化时调用的接口
    def __getstate__(self):
      print("___序列化___")
      return {"name": self.name}  # 只序列化一个参数
  	
    # pickle 反序列化时调用的接口 
    def __setstate__(self, state):  # 参数必须和构造函数接收的参数一样
      print("___反序列化___")
      self.name = state['name']
  
  
  d = Demo('tom', 12)
  ret1 = pickle.dumps(d)
  ret2 = pickle.loads(ret1)
  print(ret2.name)
  print(ret2.age)
  
  
  # __序列化___
  # ___反序列化___
  # tom
  # Traceback (most recent call last): -> 没有序列化这个属性，所以报错处理
  ```

  

